# 74xx Series Checker
汎用ロジックIC（以降74シリーズ）の刻印が見えづらくて、どの74シリーズか判別がつかなくなることがある。  
場合によっては、配線ミスや足の欠落などにより動作しない場合もある。  
（※コレはこれで、動作不良部位を見出す訓練にもなるが、初期ではシナリオ通りの動作であった方が良い）  
それらのトラブルを回避し、刻印を読むことを目的とせず、実習を通じて論理的思考に意識を寄せたい。  

そこで、74シリーズの判定と各ビットの動作是非を表示するガジェットをArduino MicroProで作製していた。  
しかし、Arduino系は、コスト高・ソースコードの管理がメンドい（こういうところで管理すればいいだけだが、作った勢いで満足してしまいソースコードをなくしてしまった）ため、**RP2040**系に移植することにした。  
また、今回使用したマイコンの端子は、**USB Type-C**であることから、将来的なケーブル問題の懸念も解消しやすいと思う。

![PXL_20230906_085409631](https://github.com/T-zakisan/74xx_Series_Checker/assets/43605763/156c24be-dab8-4769-a165-057776e5a8d8)



## 動作しているの様子
７４シリーズをＩＣソケットにセットし、マイコンのリセットボタンを押すことでロジックＩＣの種類がＬＣＤに表示される（NANDの場合：`00 NAND`）。  
機能しているビットは、そのナンバーが表示される（1-4番目のビットが機能している場合：`1234__/4`）。  
あるビットが機能していない場合や足が折れている場合は、`x`が表示される（3番目が機能していない場合：`12x4__/4`）。
対応していないロジックＩＣやロジックＩＣをセットしていない場合は、`UnKnown！`と表示される。  



https://github.com/T-zakisan/74xx_Series_Checker/assets/43605763/a2278c76-78e3-49d2-b7b0-828096098356






## 判定に対応しているロジックＩＣ
ここで対応する74シリーズは、以下とものとしている。  
また、14ピンに限る。
| 型番 | ロジック名 |
|:----:|----|
| 7400 | NAND |
| 7402 | NOR |
| 7404 | NOT |
| 7408 | AND |
| 7432 | OR |
| 7486 | Ex-OR |


## 表示の意味
液晶ディスプレイに以下の内容を表示する

| 項目名 | 例 |
|:----:|:----|
| 型番下２桁 | 74xxのxxの部分　NANDなら**00** |
| ロジック名 | NAND、ORなど |
| 可動ビット | NOTなら1-6、それ以外なら1-4　（不良はx） |
| 総ビット数 | NOTなら6、それ以外なら4 |



# 作成方法
## パーツリスト
| パーツ名 | 備考 |
|:----|:----|
| [RP2040マイコンボードキット](https://akizukidenshi.com/catalog/g/gK-17542/) | [CirCuitPythonのファームウェアを書き込むこと](https://circuitpython.org/board/raspberry_pi_pico/) |
| [ゼロプレッシャーＩＣソケット 14P](https://akizukidenshi.com/catalog/g/gP-12073/) ||
| [Ｉ２Ｃ接続小型ＬＣＤモジュール（8×2行）ピッチ変換キット](https://akizukidenshi.com/catalog/g/gK-06795/) ||
| [角型ランド両面スルーホールガラスコンポジット・ユニバーサル基板 Cタイプ(72×47mm)](https://akizukidenshi.com/catalog/g/gP-09747/) ||
| ネジ　M3xN10mm | 4 |
| ナット　M3 | 4 |
| ネジ　M2x10mm | 2 |
| ナット　M2 | 2 |
| アクリル板 | 2mm |
| ジャンパ線 | 適当 |



## アサイン
下表のアサインに従い配線を施す。  
ちなみに配線の取り回しの関係からGPIOで`GND`や`Vcc(3.3V)`を得ているが、マイコンオンボード上のソレを利用して問題ない。  
独自にアサインを変更した場合は、上記ソースコード(`code.py`)を書き換えること！

| マイコン端子 | パーツ端子 | 備考|
|:----:|:----|:----|
| 0 | LCD (Vcc) |  |
| 1 | LCD, Sw (GND) |  |
| 2 | 74シリーズ (4) | In / Output |
| 3 | 74シリーズ (1) | In / Output |
| 4 | 74シリーズ (2) | In / Output |
| 5 | 74シリーズ (3) | In / Output |
| 6 | 74シリーズ (14) | Vcc |
| 7 | 74シリーズ (13) | In / Output |
| 8 | 74シリーズ (12) | In / Output |
| 9 | 74シリーズ (11) | In / Output |
| 10 | 74シリーズ (10) | In / Output |
| 11 | 74シリーズ (9) | In / Output |
| 12 | 74シリーズ (8) | In / Output |
| 13 | 74シリーズ (5) | In / Output |
| 14 | 74シリーズ (6) | In / Output |
| 15 | 74シリーズ (7) | GND |
| 26 | LCD (SDA) |  |
| 27 | LCD (SCL) |  |
| 28 | SW (+) |  |



![PXL_20230906_125826660](https://github.com/T-zakisan/74xx_Series_Checker/assets/43605763/e16e0275-b2d5-45fc-b604-68fefb651746)





## 必須ライブラリ
| ライブラリ名 | 備考|
|:----|:----|
| st7032i.py | [LCDで使用](https://gist.github.com/boochow/6ffd0c939abbcc1a9c62bf6ab6b60cef#file-st7032i-py) |



## プログラム
1. マイコンに[ファームウェア](https://circuitpython.org/board/raspberry_pi_pico/)を書き込む
   - Pico用のファームウェアで問題ない
   - 書き込み方は、[ココ](https://learn.adafruit.com/welcome-to-circuitpython/installing-circuitpython)を見るか、`CirCuitPython ファームウェア 書き込み方法` でググると日本語のドキュメントがヒットする
2. 上記のライブラリ`st7032i.py`を`マイコン内の/lib`に保存
3. 上記の `code.py` をマイコンに保存




## ケース
必要に応じて、上記の3Dプリンタ用のファイル(.STL)とレーザー加工用ファイル(.DXF、.SVG)を用いてケースを作成する

| ファイル種 | 備考|
|:----|:----|
| STL | ３Ｄプリンタで印刷 |
| DXF | レーザー加工機でアクリル板（２ｍｍ）を切断・彫刻 |
| SVG | 　〃　 |

![3Dモデル](https://github.com/T-zakisan/74xx_Series_Checker/assets/43605763/fa5a7cfd-f1e0-4d45-9869-e81ebbe8d518)






# 使用方法
1. ＩＣソケットのバーを上げる
2. ＩＣソケットに７４シリーズを装着
   - ＩＣソケットのバー側が**ロジックＩＣの欠け**のある向きにすること！
3. ボタンを押す　　以上



# 反省
当初マイコンオンボードにある***RUN***ボタンを押すことで、ロジックＩＣの判定を行っていた。  
しかし、CirCuitPythonは起動にやや時間がかかるため、***RUN***ボタンを押してから、ロジックＩＣの判定までにタイムラグがあった。  
そこで、別途タクトスイッチを追加し、そのスイッチを押したときに判定することで、再起動を回避した。  
また、スイッチを押すまでは、[Alarm](**https://docs.circuitpython.org/en/latest/shared-bindings/alarm/index.html**)(**light sleep**)を利用することでプログラムを停止させ、消費電力を低減させている。  

念のため、それぞれの動作方法によるソースコードやケースデータ(.STL, .SVG)を置いておく。   
ディレクトリ名は、以下の通りとする。


| 動作方法 | ディレクトリ名 |
|:----|:----|
| Runスイッチ | RunSw |
| タクトスイッチ | ReLoadSw |

